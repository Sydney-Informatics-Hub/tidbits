<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  How to turn MS Word DOCX into JSON | SIH Tech Tidbits
</title>
  <link rel="canonical" href="https://sydney-informatics-hub.github.io/tidbits/how-to-turn-ms-word-docx-into-json.html">


  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/theme/css/pygments/paraiso-dark.min.css">
  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/theme/css/theme.css">
  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/static/css/tag_cloud.css">

  <link rel="alternate" type="application/atom+xml" title="Full Atom Feed"
        href="https://sydney-informatics-hub.github.io/tidbits/feeds/all.atom.xml">
  <link rel="alternate" type="application/atom+xml" title="Categories Atom Feed"
        href="https://sydney-informatics-hub.github.io/tidbits/feeds/python.atom.xml">  
  <meta name="description" content="Turn DOCX files into JSON Do you have some Microsoft Word documents in DOCX format, but for some reason you'd like to work with JSON files? Well you are in â€¦">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TNWWV3HK57"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TNWWV3HK57');
</script>
</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
  <div class="col-sm-12">
    <h1 class="title"><a href="https://sydney-informatics-hub.github.io/tidbits/">SIH Tech Tidbits</a></h1>
      <p class="text-muted">Useful tips, libraries and tools from the <a href='https://www.sydney.edu.au/research/facilities/sydney-informatics-hub.html'>Sydney Informatics Hub</a> team</p>
  </div>
</div>

<div id="search_box">
  <h5 class="h5">Search:</h5>
  <form>
    <div class="form-row">
      <div class="col-auto">
        <input
          class="form-control"
          type="text"
          name="q"
          id="tipue_search_input"
          pattern=".{3,}"
          title="At least 3 characters"
          required
        />
      </div>
      <div class="col-auto">
        <button type="submit" class="btn btn-primary">
          <span class="fa fa-search"></span>
        </button>
      </div>
    </div>
  </form>
  <div id="tipue_search_content"></div>
</div>

    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  How to turn MS Word DOCX into JSON
</h1>
      <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2020-07-14T00:00:00+10:00">
          <i class="fas fa-clock"></i>
          Tue 14 July 2020
        </li>
        <li class="list-inline-item">
          <i class="fas fa-folder-open"></i>
          <a href="https://sydney-informatics-hub.github.io/tidbits/category/python.html">Python</a>
        </li>
          <li class="list-inline-item">
            <i class="fas fa-user"></i>
              <a href="https://sydney-informatics-hub.github.io/tidbits/author/henry-lydecker.html">Henry Lydecker</a>          </li>
          <li class="list-inline-item">
            <i class="fas fa-tag"></i>
              <a href="https://sydney-informatics-hub.github.io/tidbits/tag/python.html">#Python</a>,               <a href="https://sydney-informatics-hub.github.io/tidbits/tag/word.html">#Word</a>,               <a href="https://sydney-informatics-hub.github.io/tidbits/tag/json.html">#JSON</a>          </li>
      </ul>
    </header>
    <div class="content">
      <h1>Turn DOCX files into JSON</h1>
<p>Do you have some Microsoft Word documents in DOCX format, but for some reason you'd like to work with JSON files? Well you are in luck! You can fairly easily convert a DOCX file into JSON.</p>
<h2>DOCX, aka Office Open XML</h2>
<p>When people think of DOCX files, they usually just imagine files that look like formatted text files. However, this processed and formatted text document is actually the result of a recipe for constructing and formatting the document that is stored within DOCX. A DOCX is actually a zipped XML file: the XML file contains all of the actual text content as well as all the information needed for formatting and structuring the documents that we look at in Microsoft Word.</p>
<p>If you are familiar with XML and/or JSON, it should then come as no surprise that there are numerous options for converting back and forth between these two formats.</p>
<h2>Conversion workflow</h2>
<p>Converting from DOCX to JSON is simple. The Python utility simplify-docx provides this functionality through the simplify function.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Setup</span>
<span class="kn">import</span> <span class="nn">docx</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">simplify_docx</span> <span class="kn">import</span> <span class="n">simplify</span>
<span class="kn">from</span>  <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>

<span class="c1"># Load source DOCX file</span>
<span class="n">doc_test</span> <span class="o">=</span> <span class="n">docx</span><span class="o">.</span><span class="n">Document</span><span class="p">(</span><span class="n">insert_docx_file_here</span><span class="p">)</span>
<span class="n">doc_test_json</span> <span class="o">=</span> <span class="n">simplify</span><span class="p">(</span><span class="n">doc_test</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;doc_test_json.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">doc_test_json</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>

<p>And that's it! Easy right?</p>
<p>What does this export look like? We can loop through the objects and print it out to have a look.</p>
<div class="highlight"><pre><span></span><code>for key, value in doc_test_clean.items():
    print(key, value)
</code></pre></div>

<div class="highlight"><pre><span></span><code>TYPE document
VALUE [{&#39;TYPE&#39;: &#39;body&#39;, &#39;VALUE&#39;: [{&#39;TYPE&#39;: &#39;paragraph&#39;, &#39;VALUE&#39;: [{&#39;TYPE&#39;: &#39;text&#39;, &#39;VALUE&#39;: &#39;JBRA Assisted Reproduction 2016;20(1):08-12 doi: 10.5935/1518-0557.20160003&#39;}], &#39;style&#39;: {&#39;indent&#39;: {&#39;TYPE&#39;: &#39;CT_Ind&#39;, &#39;left&#39;: 127, &#39;right&#39;: 17, &#39;firstLine&#39;: 0}}}, {&#39;TYPE&#39;: &#39;paragraph&#39;, &#39;VALUE&#39;: [{&#39;TYPE&#39;: &#39;text&#39;, &#39;VALUE&#39;: &#39;Original Article&#39;}], &#39;style&#39;: {&#39;indent&#39;: {&#39;TYPE&#39;: &#39;CT_Ind&#39;, &#39;left&#39;: 127, &#39;right&#39;: 0, &#39;firstLine&#39;: 0}}}, {&#39;TYPE&#39;: &#39;paragraph&#39;, &#39;VALUE&#39;: [{&#39;TYPE&#39;: &#39;text&#39;, &#39;VALUE&#39;: &#39;Strategies for the management of OHSS: Results from freezing-all cycles&#39;}],
</code></pre></div>

<p>That doesn't look particularly easy to read. But we can see here that we have a JSON with numerous objects that contain text information and style information.</p>
<h2>Manipulating your DOCX JSON</h2>
<p>Ok so you have a JSON now, but what if you want to remove certain parts of it? For example, what if you want to remove all tables from your document? You can loop through the objects in your JSON and make changes based on the identity of the objects.</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="k">Open</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">JSON</span>
<span class="n">doc_test_clean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">json</span><span class="p">.</span><span class="k">load</span><span class="p">(</span><span class="k">open</span><span class="p">(</span><span class="ss">&quot;doc_test_json.json&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">object_pairs_hook</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">)</span>

<span class="err">#</span><span class="w"> </span><span class="n">Prune</span><span class="w"> </span><span class="n">those</span><span class="w"> </span><span class="n">tables</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">doc_test_clean</span><span class="p">))</span><span class="err">:</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">doc_test_clean</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">&quot;TYPE&quot;</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">&quot;table&quot;</span><span class="err">:</span>
<span class="w">        </span><span class="n">doc_test_clean</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="k">break</span>
<span class="err">#</span><span class="w"> </span><span class="k">Save</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">output</span><span class="w"> </span><span class="n">JSON</span>
<span class="k">with</span><span class="w"> </span><span class="k">open</span><span class="p">(</span><span class="s1">&#39;doc_test_clean.json&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">f</span><span class="p">:</span>
<span class="w">    </span><span class="n">json</span><span class="p">.</span><span class="k">dump</span><span class="p">(</span><span class="n">doc_test_clean</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="n">ensure_ascii</span><span class="o">=</span><span class="k">False</span><span class="p">,</span><span class="w"> </span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>

<h2>Results</h2>
<p>Here is what you get once you've converted your DOCX into a JSON. We can see that our DOCX-JSON is a "document" built from multiple different sections (e.g. "body"), that are composed of numerous paragraph/style pairs. </p>
<div class="highlight"><pre><span></span><code>{
    &quot;TYPE&quot;: &quot;document&quot;,
    &quot;VALUE&quot;: [
        {
            &quot;TYPE&quot;: &quot;body&quot;,
            &quot;VALUE&quot;: [
                {
                    &quot;TYPE&quot;: &quot;paragraph&quot;,
                    &quot;VALUE&quot;: [
                        {
                            &quot;TYPE&quot;: &quot;text&quot;,
                            &quot;VALUE&quot;: &quot;JBRA Assisted Reproduction 2016;20(1):08-12 doi: 10.5935/1518-0557.20160003&quot;
                        }
                    ],
                    &quot;style&quot;: {
                        &quot;indent&quot;: {
                            &quot;TYPE&quot;: &quot;CT_Ind&quot;,
                            &quot;left&quot;: 127,
                            &quot;right&quot;: 17,
                            &quot;firstLine&quot;: 0
                        }
                    }
                },
                {
                    &quot;TYPE&quot;: &quot;paragraph&quot;,
                    &quot;VALUE&quot;: [
                        {
                            &quot;TYPE&quot;: &quot;text&quot;,
                            &quot;VALUE&quot;: &quot;Original Article&quot;
                        }
                    ],
                    &quot;style&quot;: {
                        &quot;indent&quot;: {
                            &quot;TYPE&quot;: &quot;CT_Ind&quot;,
                            &quot;left&quot;: 127,
                            &quot;right&quot;: 0,
                            &quot;firstLine&quot;: 0
                        }
                    }
                },
                {
                    &quot;TYPE&quot;: &quot;paragraph&quot;,
                    &quot;VALUE&quot;: [
                        {
                            &quot;TYPE&quot;: &quot;text&quot;,
                            &quot;VALUE&quot;: &quot;Strategies for the management of OHSS: Results from freezing-all cycles&quot;
                        }
                    ],
                    &quot;style&quot;: {
                        &quot;indent&quot;: {
                            &quot;TYPE&quot;: &quot;CT_Ind&quot;,
                            &quot;left&quot;: 123,
                            &quot;right&quot;: 30,
                            &quot;firstLine&quot;: 0
                        }
                    }
                }
                ]}]}
</code></pre></div>

<h1>"Uh, why would I want to do this?"</h1>
<p>That is a good question that I don't have a good answer for. I originally found this method when I was trying to do some cleaning of DOCX XML files. It is pretty easy to work with the XML files inside of DOCX files, but I guess there are cases where you might prefer to work with JSON files. In that case, you now know how to turn your DOCX into JSON!</p>
    </div>
  </article>
  <script src="https://giscus.app/client.js"
        data-repo="Sydney-Informatics-Hub/tidbits"
        data-repo-id="R_kgDOKKuuxw"
        data-category="Announcements"
        data-category-id="DIC_kwDOKKuux84CY0kA"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
      <li class="list-inline-item"><a href="https://sydney-informatics-hub.github.io/tidbits/authors.html">Authors</a></li>
    <li class="list-inline-item"><a href="https://sydney-informatics-hub.github.io/tidbits/archives.html">Archives</a></li>
    <li class="list-inline-item"><a href="https://sydney-informatics-hub.github.io/tidbits/categories.html">Categories</a></li>
      <li class="list-inline-item"><a href="https://sydney-informatics-hub.github.io/tidbits/tags.html">Tags</a></li>
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
  </p>
</div>    </div>
  </footer>

  <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://sydney-informatics-hub.github.io/tidbits/static/js/tipuesearch.min.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://sydney-informatics-hub.github.io/tidbits/static/js/tipuesearch_set.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://sydney-informatics-hub.github.io/tidbits/tipuesearch_content.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://sydney-informatics-hub.github.io/tidbits/static/js/activate_search.js" crossorigin="anonymous"></script>
</body>

</html>