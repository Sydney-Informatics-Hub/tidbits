<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  A comparison of piping dataframe operations in R Tidyverse vs Python Pandas | SIH Tech Tidbits
</title>
  <link rel="canonical" href="https://sydney-informatics-hub.github.io/tidbits/a-comparison-of-piping-dataframe-operations-in-r-tidyverse-vs-python-pandas.html">


  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/theme/css/pygments/paraiso-dark.min.css">
  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/theme/css/theme.css">
  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/static/css/tag_cloud.css">

  <link rel="alternate" type="application/atom+xml" title="Full Atom Feed"
        href="https://sydney-informatics-hub.github.io/tidbits/feeds/all.atom.xml">
  <link rel="alternate" type="application/atom+xml" title="Categories Atom Feed"
        href="https://sydney-informatics-hub.github.io/tidbits/feeds/python.atom.xml">  
  <meta name="description" content="Getting the dataset Flight data downloaded from https://raw.githubusercontent.com/apache-superset/examples-data/master/tutorial_flights.csv: R library(dplyr) library(readr) data <- read_csv("https://raw.githubusercontent.com/apache-superset/examples-data/master …">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TNWWV3HK57"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TNWWV3HK57');
</script>
</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
  <div class="col-sm-12">
    <h1 class="title"><a href="https://sydney-informatics-hub.github.io/tidbits/">SIH Tech Tidbits</a></h1>
      <p class="text-muted">Useful tips, libraries and tools from the <a href='https://www.sydney.edu.au/research/facilities/sydney-informatics-hub.html'>Sydney Informatics Hub</a> team</p>
  </div>
</div>

<div id="search_box">
  <h5 class="h5">Search:</h5>
  <form>
    <div class="form-row">
      <div class="col-auto">
        <input
          class="form-control"
          type="text"
          name="q"
          id="tipue_search_input"
          pattern=".{3,}"
          title="At least 3 characters"
          required
        />
      </div>
      <div class="col-auto">
        <button type="submit" class="btn btn-primary">
          <span class="fa fa-search"></span>
        </button>
      </div>
    </div>
  </form>
  <div id="tipue_search_content"></div>
</div>

    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  A comparison of piping dataframe operations in R Tidyverse vs Python Pandas
</h1>
      <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2021-05-10T00:00:00+10:00">
          <i class="fas fa-clock"></i>
          Mon 10 May 2021
        </li>
        <li class="list-inline-item">
          <i class="fas fa-folder-open"></i>
          <a href="https://sydney-informatics-hub.github.io/tidbits/category/python.html">Python</a>
        </li>
          <li class="list-inline-item">
            <i class="fas fa-user"></i>
              <a href="https://sydney-informatics-hub.github.io/tidbits/author/sergio-pintaldi.html">Sergio Pintaldi</a>          </li>
          <li class="list-inline-item">
            <i class="fas fa-tag"></i>
              <a href="https://sydney-informatics-hub.github.io/tidbits/tag/python.html">#Python</a>,               <a href="https://sydney-informatics-hub.github.io/tidbits/tag/pandas.html">#Pandas</a>,               <a href="https://sydney-informatics-hub.github.io/tidbits/tag/r.html">#R</a>,               <a href="https://sydney-informatics-hub.github.io/tidbits/tag/pipe.html">#pipe</a>,               <a href="https://sydney-informatics-hub.github.io/tidbits/tag/tidy.html">#Tidy</a>,               <a href="https://sydney-informatics-hub.github.io/tidbits/tag/dplyr.html">#dplyr</a>          </li>
      </ul>
    </header>
    <div class="content">
      <h1>Getting the dataset</h1>
<p>Flight data downloaded from https://raw.githubusercontent.com/apache-superset/examples-data/master/tutorial_flights.csv:</p>
<h2>R</h2>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span>

<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&quot;https://raw.githubusercontent.com/apache-superset/examples-data/master/tutorial_flights.csv&quot;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code>&gt;<span class="w"> </span>data<span class="w"> </span>%&gt;%<span class="w"> </span>glimpse<span class="o">()</span>
Rows:<span class="w"> </span><span class="m">2</span>,954
Columns:<span class="w"> </span><span class="m">20</span>
$<span class="w"> </span>Department<span class="w">                </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;Orange Department&quot;</span>,<span class="w"> </span><span class="s2">&quot;Yellow Department&quot;</span>,<span class="w"> </span><span class="s2">&quot;Yell…</span>
$<span class="s2"> Cost                      &lt;dbl&gt; 81.52, 343.98, 25.98, 12.99, 32.97, 61.48, 159.…</span>
$<span class="s2"> `Travel Class`            &lt;chr&gt; &quot;</span>Economy<span class="s2">&quot;, &quot;</span>Economy<span class="s2">&quot;, &quot;</span>Economy<span class="s2">&quot;, &quot;</span>Economy<span class="s2">&quot;, &quot;</span>Ec…
$<span class="w"> </span><span class="sb">`</span>Ticket<span class="w"> </span>Single<span class="w"> </span>or<span class="w"> </span>Return<span class="sb">`</span><span class="w"> </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;Return&quot;</span>,<span class="w"> </span><span class="s2">&quot;Return&quot;</span>,<span class="w"> </span><span class="s2">&quot;Return&quot;</span>,<span class="w"> </span><span class="s2">&quot;Return&quot;</span>,<span class="w"> </span><span class="s2">&quot;Return…</span>
$<span class="s2"> Airline                   &lt;chr&gt; &quot;</span>Flybe<span class="s2">&quot;, &quot;</span>Flybe<span class="s2">&quot;, &quot;</span>Flybe<span class="s2">&quot;, &quot;</span>Flybe<span class="s2">&quot;, &quot;</span>Flybe<span class="s2">&quot;, &quot;</span>F…
$<span class="w"> </span><span class="sb">`</span>Travel<span class="w"> </span>Date<span class="sb">`</span><span class="w">             </span>&lt;date&gt;<span class="w"> </span><span class="m">2011</span>-02-10,<span class="w"> </span><span class="m">2011</span>-02-11,<span class="w"> </span><span class="m">2011</span>-03-02,<span class="w"> </span><span class="m">2011</span>-03-09…
$<span class="w"> </span><span class="sb">`</span>Origin<span class="w"> </span>ICAO<span class="sb">`</span><span class="w">             </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;EGPF&quot;</span>,<span class="w"> </span><span class="s2">&quot;EGPF&quot;</span>,<span class="w"> </span><span class="s2">&quot;EGHI&quot;</span>,<span class="w"> </span><span class="s2">&quot;EGHI&quot;</span>,<span class="w"> </span><span class="s2">&quot;EGPE&quot;</span>,<span class="w"> </span><span class="s2">&quot;EGPE&quot;</span>,…
$<span class="w"> </span><span class="sb">`</span>Origin<span class="w"> </span>Name<span class="sb">`</span><span class="w">             </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;Glasgow International Airport&quot;</span>,<span class="w"> </span><span class="s2">&quot;Glasgow Inter…</span>
$<span class="s2"> `Origin Municipality`     &lt;chr&gt; &quot;</span>Glasgow<span class="s2">&quot;, &quot;</span>Glasgow<span class="s2">&quot;, &quot;</span>Southampton<span class="s2">&quot;, &quot;</span>Southampt…
$<span class="w"> </span><span class="sb">`</span>Origin<span class="w"> </span>Region<span class="sb">`</span><span class="w">           </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;Scotland&quot;</span>,<span class="w"> </span><span class="s2">&quot;Scotland&quot;</span>,<span class="w"> </span><span class="s2">&quot;England&quot;</span>,<span class="w"> </span><span class="s2">&quot;England&quot;</span>,<span class="w"> </span><span class="s2">&quot;…</span>
$<span class="s2"> `Origin Country`          &lt;chr&gt; &quot;</span>United<span class="w"> </span>Kingdom<span class="s2">&quot;, &quot;</span>United<span class="w"> </span>Kingdom<span class="s2">&quot;, &quot;</span>United<span class="w"> </span>Kin…
$<span class="w"> </span><span class="sb">`</span>Origin<span class="w"> </span>Latitude<span class="sb">`</span><span class="w">         </span>&lt;dbl&gt;<span class="w"> </span><span class="m">55</span>.8719,<span class="w"> </span><span class="m">55</span>.8719,<span class="w"> </span><span class="m">50</span>.9503,<span class="w"> </span><span class="m">50</span>.9503,<span class="w"> </span><span class="m">57</span>.5425,<span class="w"> </span><span class="m">57</span>…
$<span class="w"> </span><span class="sb">`</span>Origin<span class="w"> </span>Longitude<span class="sb">`</span><span class="w">        </span>&lt;dbl&gt;<span class="w"> </span>-4.433060,<span class="w"> </span>-4.433060,<span class="w"> </span>-1.356800,<span class="w"> </span>-1.356800,<span class="w"> </span>-4.…
$<span class="w"> </span><span class="sb">`</span>Destination<span class="w"> </span>ICAO<span class="sb">`</span><span class="w">        </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;EGKK&quot;</span>,<span class="w"> </span><span class="s2">&quot;EGHI&quot;</span>,<span class="w"> </span><span class="s2">&quot;EGPB&quot;</span>,<span class="w"> </span><span class="s2">&quot;EPKK&quot;</span>,<span class="w"> </span><span class="s2">&quot;EGKK&quot;</span>,<span class="w"> </span><span class="s2">&quot;EGBB&quot;</span>,…
$<span class="w"> </span><span class="sb">`</span>Destination<span class="w"> </span>Name<span class="sb">`</span><span class="w">        </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;London Gatwick Airport&quot;</span>,<span class="w"> </span><span class="s2">&quot;Southampton Airport&quot;</span>…
$<span class="w"> </span><span class="sb">`</span>Destination<span class="w"> </span>Region<span class="sb">`</span><span class="w">      </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;England&quot;</span>,<span class="w"> </span><span class="s2">&quot;England&quot;</span>,<span class="w"> </span><span class="s2">&quot;Scotland&quot;</span>,<span class="w"> </span><span class="s2">&quot;Lesser Polan…</span>
$<span class="s2"> `Destination Country`     &lt;chr&gt; &quot;</span>United<span class="w"> </span>Kingdom<span class="s2">&quot;, &quot;</span>United<span class="w"> </span>Kingdom<span class="s2">&quot;, &quot;</span>United<span class="w"> </span>Kin…
$<span class="w"> </span><span class="sb">`</span>Destination<span class="w"> </span>Latitude<span class="sb">`</span><span class="w">    </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;51.148102&quot;</span>,<span class="w"> </span><span class="s2">&quot;50.9502983093262&quot;</span>,<span class="w"> </span><span class="s2">&quot;59.8788986206…</span>
$<span class="s2"> `Destination Longitude`   &lt;chr&gt; &quot;</span>-0.190278<span class="s2">&quot;, &quot;</span>-1.35679996013641<span class="s2">&quot;, &quot;</span>-1.295560002…
$<span class="w"> </span>Distance<span class="w">                  </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;595&quot;</span>,<span class="w"> </span><span class="s2">&quot;584&quot;</span>,<span class="w"> </span><span class="s2">&quot;993&quot;</span>,<span class="w"> </span><span class="s2">&quot;1493&quot;</span>,<span class="w"> </span><span class="s2">&quot;753&quot;</span>,<span class="w"> </span><span class="s2">&quot;584&quot;</span>,<span class="w"> </span><span class="s2">&quot;508…</span>
</code></pre></div>

<h2>Python</h2>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/apache-superset/examples-data/master/tutorial_flights.csv&quot;</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span>
<span class="n">Index</span><span class="p">([</span><span class="s1">&#39;Department&#39;</span><span class="p">,</span> <span class="s1">&#39;Cost&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel Class&#39;</span><span class="p">,</span> <span class="s1">&#39;Ticket Single or Return&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Airline&#39;</span><span class="p">,</span> <span class="s1">&#39;Travel Date&#39;</span><span class="p">,</span> <span class="s1">&#39;Origin ICAO&#39;</span><span class="p">,</span> <span class="s1">&#39;Origin Name&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Origin Municipality&#39;</span><span class="p">,</span> <span class="s1">&#39;Origin Region&#39;</span><span class="p">,</span> <span class="s1">&#39;Origin Country&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Origin Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Origin Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Destination ICAO&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Destination Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Destination Region&#39;</span><span class="p">,</span> <span class="s1">&#39;Destination Country&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Destination Latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Destination Longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;Distance&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</code></pre></div>

<h1>Creating New columns from old ones</h1>
<h2>R</h2>
<div class="highlight"><pre><span></span><code>&gt;<span class="w"> </span>data<span class="w"> </span>%&gt;%
<span class="w">  </span>group_by<span class="o">(</span><span class="sb">`</span>Destination<span class="w"> </span>Country<span class="sb">`</span><span class="o">)</span><span class="w"> </span>%&gt;%
<span class="w">  </span>mutate<span class="o">(</span>
<span class="w">    </span><span class="nv">total_cost_per_country</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>sum<span class="o">(</span>Cost<span class="o">)</span>,
<span class="w">    </span><span class="nv">tot_cost_country_euro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>total_cost_per_country<span class="w"> </span>*<span class="w"> </span><span class="m">1</span>.3
<span class="w">  </span><span class="o">)</span><span class="w"> </span>%&gt;%
<span class="w">  </span>glimpse<span class="o">()</span>
Rows:<span class="w"> </span><span class="m">2</span>,954
Columns:<span class="w"> </span><span class="m">22</span>
Groups:<span class="w"> </span>Destination<span class="w"> </span>Country<span class="w"> </span><span class="o">[</span><span class="m">65</span><span class="o">]</span>
$<span class="w"> </span>Department<span class="w">                </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;Orange Department&quot;</span>,<span class="w"> </span><span class="s2">&quot;Yellow Department&quot;</span>,<span class="w"> </span><span class="s2">&quot;Yello…</span>
$<span class="s2"> Cost                      &lt;dbl&gt; 81.52, 343.98, 25.98, 12.99, 32.97, 61.48, 159.8…</span>
$<span class="s2"> `Travel Class`            &lt;chr&gt; &quot;</span>Economy<span class="s2">&quot;, &quot;</span>Economy<span class="s2">&quot;, &quot;</span>Economy<span class="s2">&quot;, &quot;</span>Economy<span class="s2">&quot;, &quot;</span>Eco…
$<span class="w"> </span><span class="sb">`</span>Ticket<span class="w"> </span>Single<span class="w"> </span>or<span class="w"> </span>Return<span class="sb">`</span><span class="w"> </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;Return&quot;</span>,<span class="w"> </span><span class="s2">&quot;Return&quot;</span>,<span class="w"> </span><span class="s2">&quot;Return&quot;</span>,<span class="w"> </span><span class="s2">&quot;Return&quot;</span>,<span class="w"> </span><span class="s2">&quot;Return&quot;</span>…
$<span class="w"> </span>Airline<span class="w">                   </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;Flybe&quot;</span>,<span class="w"> </span><span class="s2">&quot;Flybe&quot;</span>,<span class="w"> </span><span class="s2">&quot;Flybe&quot;</span>,<span class="w"> </span><span class="s2">&quot;Flybe&quot;</span>,<span class="w"> </span><span class="s2">&quot;Flybe&quot;</span>,<span class="w"> </span><span class="s2">&quot;Fl…</span>
$<span class="s2"> `Travel Date`             &lt;date&gt; 2011-02-10, 2011-02-11, 2011-03-02, 2011-03-09,…</span>
$<span class="s2"> `Origin ICAO`             &lt;chr&gt; &quot;</span>EGPF<span class="s2">&quot;, &quot;</span>EGPF<span class="s2">&quot;, &quot;</span>EGHI<span class="s2">&quot;, &quot;</span>EGHI<span class="s2">&quot;, &quot;</span>EGPE<span class="s2">&quot;, &quot;</span>EGPE<span class="s2">&quot;, …</span>
$<span class="s2"> `Origin Name`             &lt;chr&gt; &quot;</span>Glasgow<span class="w"> </span>International<span class="w"> </span>Airport<span class="s2">&quot;, &quot;</span>Glasgow<span class="w"> </span>Intern…
$<span class="w"> </span><span class="sb">`</span>Origin<span class="w"> </span>Municipality<span class="sb">`</span><span class="w">     </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;Glasgow&quot;</span>,<span class="w"> </span><span class="s2">&quot;Glasgow&quot;</span>,<span class="w"> </span><span class="s2">&quot;Southampton&quot;</span>,<span class="w"> </span><span class="s2">&quot;Southampto…</span>
$<span class="s2"> `Origin Region`           &lt;chr&gt; &quot;</span>Scotland<span class="s2">&quot;, &quot;</span>Scotland<span class="s2">&quot;, &quot;</span>England<span class="s2">&quot;, &quot;</span>England<span class="s2">&quot;, &quot;</span>S…
$<span class="w"> </span><span class="sb">`</span>Origin<span class="w"> </span>Country<span class="sb">`</span><span class="w">          </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;United Kingdom&quot;</span>,<span class="w"> </span><span class="s2">&quot;United Kingdom&quot;</span>,<span class="w"> </span><span class="s2">&quot;United King…</span>
$<span class="s2"> `Origin Latitude`         &lt;dbl&gt; 55.8719, 55.8719, 50.9503, 50.9503, 57.5425, 57.…</span>
$<span class="s2"> `Origin Longitude`        &lt;dbl&gt; -4.433060, -4.433060, -1.356800, -1.356800, -4.0…</span>
$<span class="s2"> `Destination ICAO`        &lt;chr&gt; &quot;</span>EGKK<span class="s2">&quot;, &quot;</span>EGHI<span class="s2">&quot;, &quot;</span>EGPB<span class="s2">&quot;, &quot;</span>EPKK<span class="s2">&quot;, &quot;</span>EGKK<span class="s2">&quot;, &quot;</span>EGBB<span class="s2">&quot;, …</span>
$<span class="s2"> `Destination Name`        &lt;chr&gt; &quot;</span>London<span class="w"> </span>Gatwick<span class="w"> </span>Airport<span class="s2">&quot;, &quot;</span>Southampton<span class="w"> </span>Airport<span class="s2">&quot;,…</span>
$<span class="s2"> `Destination Region`      &lt;chr&gt; &quot;</span>England<span class="s2">&quot;, &quot;</span>England<span class="s2">&quot;, &quot;</span>Scotland<span class="s2">&quot;, &quot;</span>Lesser<span class="w"> </span>Poland…
$<span class="w"> </span><span class="sb">`</span>Destination<span class="w"> </span>Country<span class="sb">`</span><span class="w">     </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;United Kingdom&quot;</span>,<span class="w"> </span><span class="s2">&quot;United Kingdom&quot;</span>,<span class="w"> </span><span class="s2">&quot;United King…</span>
$<span class="s2"> `Destination Latitude`    &lt;chr&gt; &quot;</span><span class="m">51</span>.148102<span class="s2">&quot;, &quot;</span><span class="m">50</span>.9502983093262<span class="s2">&quot;, &quot;</span><span class="m">59</span>.87889862060…
$<span class="w"> </span><span class="sb">`</span>Destination<span class="w"> </span>Longitude<span class="sb">`</span><span class="w">   </span>&lt;chr&gt;<span class="w"> </span><span class="s2">&quot;-0.190278&quot;</span>,<span class="w"> </span><span class="s2">&quot;-1.35679996013641&quot;</span>,<span class="w"> </span><span class="s2">&quot;-1.2955600023…</span>
$<span class="s2"> Distance                  &lt;chr&gt; &quot;</span><span class="m">595</span><span class="s2">&quot;, &quot;</span><span class="m">584</span><span class="s2">&quot;, &quot;</span><span class="m">993</span><span class="s2">&quot;, &quot;</span><span class="m">1493</span><span class="s2">&quot;, &quot;</span><span class="m">753</span><span class="s2">&quot;, &quot;</span><span class="m">584</span><span class="s2">&quot;, &quot;</span><span class="m">508</span><span class="s2">&quot;…</span>
$<span class="s2"> total_cost_per_country    &lt;dbl&gt; 376846.33, 376846.33, 376846.33, 4968.51, 376846…</span>
$<span class="s2"> tot_cost_country_euro     &lt;dbl&gt; 489900.229, 489900.229, 489900.229, 6459.063, 48…</span>
</code></pre></div>

<h2>Python</h2>
<p>Same as above, and printing out the first 5 rows of the last 5 columns:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span>
    <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
        <span class="n">total_cost_per_country</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">x</span><span class="p">[[</span><span class="s2">&quot;Destination Country&quot;</span><span class="p">,</span> <span class="s2">&quot;Cost&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Destination Country&quot;</span><span class="p">)[</span><span class="s2">&quot;Cost&quot;</span><span class="p">]</span>
            <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
        <span class="p">),</span>
        <span class="n">tot_cost_country_euro</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;total_cost_per_country&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.3</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
    <span class="o">.</span><span class="n">to_markdown</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div>

<p>Code output:</p>
<table>
<thead>
<tr>
<th style="text-align: right;"></th>
<th style="text-align: right;">Destination Latitude</th>
<th style="text-align: right;">Destination Longitude</th>
<th style="text-align: right;">Distance</th>
<th style="text-align: right;">total_cost_per_country</th>
<th style="text-align: right;">tot_cost_country_euro</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">0</td>
<td style="text-align: right;">51.1481</td>
<td style="text-align: right;">-0.190278</td>
<td style="text-align: right;">595</td>
<td style="text-align: right;">376846.33</td>
<td style="text-align: right;">489900.23</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">50.9503</td>
<td style="text-align: right;">-1.3568</td>
<td style="text-align: right;">584</td>
<td style="text-align: right;">376846.33</td>
<td style="text-align: right;">489900.23</td>
</tr>
<tr>
<td style="text-align: right;">2</td>
<td style="text-align: right;">59.8789</td>
<td style="text-align: right;">-1.29556</td>
<td style="text-align: right;">993</td>
<td style="text-align: right;">376846.33</td>
<td style="text-align: right;">489900.23</td>
</tr>
<tr>
<td style="text-align: right;">3</td>
<td style="text-align: right;">50.0777</td>
<td style="text-align: right;">19.7848</td>
<td style="text-align: right;">1493</td>
<td style="text-align: right;">4968.51</td>
<td style="text-align: right;">6459.06</td>
</tr>
<tr>
<td style="text-align: right;">4</td>
<td style="text-align: right;">51.1481</td>
<td style="text-align: right;">-0.190278</td>
<td style="text-align: right;">753</td>
<td style="text-align: right;">376846.33</td>
<td style="text-align: right;">489900.23</td>
</tr>
</tbody>
</table>
<h1>Data viz example</h1>
<p>A classic groupby, apply aggregation and filtering and plot stuffs</p>
<h2>R</h2>
<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">filter</span><span class="p">(</span><span class="n">`Origin Country`</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Germany&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="c1"># glimpse()</span>
<span class="w">  </span><span class="nf">select</span><span class="p">(</span><span class="n">`Origin Municipality`</span><span class="p">,</span><span class="w"> </span><span class="n">Cost</span><span class="p">,</span><span class="w"> </span><span class="n">Department</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">group_by</span><span class="p">(</span><span class="n">`Origin Municipality`</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span><span class="n">total_cost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">Cost</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">`Origin Municipality`</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">total_cost</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Department</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;identity&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Output:</p>
<p><img alt="" src="https://sydney-informatics-hub.github.io/tidbits/images/dataframe-pipe-r-vs-pandas/r_plot.png"></p>
<h2>Python</h2>
<div class="highlight"><pre><span></span><code><span class="p">(</span>
    <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Origin Country&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Germany&quot;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Origin Municipality&quot;</span><span class="p">,</span> <span class="s2">&quot;Department&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span>
        <span class="n">total_cost</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">NamedAgg</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;Cost&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Origin Municipality&quot;</span><span class="p">],</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Department&quot;</span><span class="p">],</span>
        <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;total_cost&quot;</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">get_figure</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div>

<p>Output:</p>
<p><img alt="" src="https://sydney-informatics-hub.github.io/tidbits/images/dataframe-pipe-r-vs-pandas/python_plot.png"></p>
<h1>Data pipelines</h1>
<p>A classic data pipeline with loading, processing, writing steps:</p>
<h2>R</h2>
<div class="highlight"><pre><span></span><code><span class="n">read_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">df</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="w"> </span><span class="kc">...</span><span class="p">)</span>
<span class="w">  </span><span class="nf">return</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">process_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">df_out</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="s">&quot;group_col&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">mutate</span><span class="p">(</span>
<span class="w">      </span><span class="n">new_col1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">col1</span><span class="p">),</span>
<span class="w">      </span><span class="n">new_col2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">col2</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="kc">...</span>
<span class="w">  </span><span class="nf">return</span><span class="p">(</span><span class="n">df_out</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">write_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="w"> </span><span class="n">outfilename</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">df_out</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="n">col1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">col2</span><span class="p">)</span>
<span class="w">  </span><span class="nf">write_csv</span><span class="p">(</span><span class="n">df_out</span><span class="p">,</span><span class="w"> </span><span class="n">outfilename</span><span class="p">)</span>

<span class="w">  </span><span class="nf">return</span><span class="p">(</span><span class="n">df_out</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_data</span><span class="p">(</span><span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;path/to/input/file&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">process_data</span><span class="p">(</span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">write_data</span><span class="p">(</span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">outfilename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;path/to/output/file&quot;</span><span class="p">)</span>
</code></pre></div>

<h2>Python</h2>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dataframe</span><span class="p">:</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">colums</span> <span class="o">=</span> <span class="p">,</span> <span class="o">...</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="k">def</span> <span class="nf">process_data</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">Dataframe</span><span class="p">):</span>
    <span class="n">df_out</span> <span class="o">=</span> <span class="n">df</span>
    <span class="n">df_out</span><span class="p">[[</span><span class="s2">&quot;new_col1&quot;</span><span class="p">,</span> <span class="s2">&quot;new_col2&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;group_col&quot;</span><span class="p">,</span> <span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;group_col&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">agg</span><span class="p">({</span>
            <span class="s2">&quot;col1&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span>
            <span class="s2">&quot;col2&quot;</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span>
        <span class="p">})</span>
    <span class="p">)</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">df_out</span>

<span class="k">def</span> <span class="nf">write_data</span><span class="p">(</span><span class="n">df</span><span class="p">:</span> <span class="n">Dataframe</span><span class="p">,</span> <span class="n">outfilename</span><span class="p">):</span>
    <span class="n">df_out</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;col1&quot;</span><span class="p">,</span> <span class="s2">&quot;col2&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">outfilename</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_out</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">data</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">read_data</span><span class="p">(</span><span class="s2">&quot;path/to/input/file&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">process_data</span><span class="p">)</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">write_data</span><span class="p">,</span> <span class="n">outfilename</span><span class="o">=</span><span class="s2">&quot;path/to/output/file&quot;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
    </div>
  </article>
  <script src="https://giscus.app/client.js"
        data-repo="Sydney-Informatics-Hub/tidbits"
        data-repo-id="R_kgDOKKuuxw"
        data-category="Announcements"
        data-category-id="DIC_kwDOKKuux84CY0kA"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
      <li class="list-inline-item"><a href="https://sydney-informatics-hub.github.io/tidbits/authors.html">Authors</a></li>
    <li class="list-inline-item"><a href="https://sydney-informatics-hub.github.io/tidbits/archives.html">Archives</a></li>
    <li class="list-inline-item"><a href="https://sydney-informatics-hub.github.io/tidbits/categories.html">Categories</a></li>
      <li class="list-inline-item"><a href="https://sydney-informatics-hub.github.io/tidbits/tags.html">Tags</a></li>
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
  </p>
</div>    </div>
  </footer>

  <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://sydney-informatics-hub.github.io/tidbits/static/js/tipuesearch.min.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://sydney-informatics-hub.github.io/tidbits/static/js/tipuesearch_set.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://sydney-informatics-hub.github.io/tidbits/tipuesearch_content.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://sydney-informatics-hub.github.io/tidbits/static/js/activate_search.js" crossorigin="anonymous"></script>
</body>

</html>