<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  Annotated heatmaps in R with ComplexHeatmap | SIH Tech Tidbits
</title>
  <link rel="canonical" href="https://sydney-informatics-hub.github.io/tidbits/annotated-heatmaps-in-r-with-complexheatmap.html">


  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/theme/css/pygments/paraiso-dark.min.css">
  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/theme/css/theme.css">
  <link rel="stylesheet" href="https://sydney-informatics-hub.github.io/tidbits/static/css/tag_cloud.css">

  <link rel="alternate" type="application/atom+xml" title="Full Atom Feed"
        href="https://sydney-informatics-hub.github.io/tidbits/feeds/all.atom.xml">
  <link rel="alternate" type="application/atom+xml" title="Categories Atom Feed"
        href="https://sydney-informatics-hub.github.io/tidbits/feeds/r.atom.xml">  
  <meta name="description" content="Annotated heatmaps in R with ComplexHeatmap A plethora of custom heatmap packages exist for R, but the one capable of building some of the most complex, publication-ready heatmaps is called â€¦">
  <script>
    (function(i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function() {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o);
      a.async = 1;
      a.src = g;
      m = s.getElementsByTagName(o)[0];
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'G-TNWWV3HK57', 'auto');
    ga('send', 'pageview');
  </script>


</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
  <div class="col-sm-12">
    <h1 class="title"><a href="https://sydney-informatics-hub.github.io/tidbits/">SIH Tech Tidbits</a></h1>
      <p class="text-muted">Useful tips, libraries and tools from the <a href='https://www.sydney.edu.au/research/facilities/sydney-informatics-hub.html'>Sydney Informatics Hub</a> team</p>
  </div>
</div>

<div id="search_box">
  <h5 class="h5">Search:</h5>
  <form>
    <div class="form-row">
      <div class="col-auto">
        <input
          class="form-control"
          type="text"
          name="q"
          id="tipue_search_input"
          pattern=".{3,}"
          title="At least 3 characters"
          required
        />
      </div>
      <div class="col-auto">
        <button type="submit" class="btn btn-primary">
          <span class="fa fa-search"></span>
        </button>
      </div>
    </div>
  </form>
  <div id="tipue_search_content"></div>
</div>

    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  Annotated heatmaps in R with ComplexHeatmap
</h1>
      <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2020-10-29T00:00:00+11:00">
          <i class="fas fa-clock"></i>
          Thu 29 October 2020
        </li>
        <li class="list-inline-item">
          <i class="fas fa-folder-open"></i>
          <a href="https://sydney-informatics-hub.github.io/tidbits/category/r.html">R</a>
        </li>
          <li class="list-inline-item">
            <i class="fas fa-user"></i>
              <a href="https://sydney-informatics-hub.github.io/tidbits/author/jazmin-ozsvar.html">Jazmin Ozsvar</a>          </li>
          <li class="list-inline-item">
            <i class="fas fa-tag"></i>
              <a href="https://sydney-informatics-hub.github.io/tidbits/tag/r.html">#r</a>,               <a href="https://sydney-informatics-hub.github.io/tidbits/tag/heatmap.html">#heatmap</a>,               <a href="https://sydney-informatics-hub.github.io/tidbits/tag/annotation.html">#annotation</a>,               <a href="https://sydney-informatics-hub.github.io/tidbits/tag/bioinformatics.html">#bioinformatics</a>          </li>
      </ul>
    </header>
    <div class="content">
      <h2>Annotated heatmaps in R with ComplexHeatmap</h2>
<p>A plethora of custom heatmap packages exist for R, but the one capable of building some of the most complex, publication-ready heatmaps is called <code>ComplexHeatmap</code>. The power of this package lies in its ability to annotate the basic heatmap with categorical/continuous scales, or even plots (boxplots, barplots, distributions etc) to get a better sense of the data.  <code>ComplexHeatmap</code> was initially designed with bioinformatics analyses such as gene expression in mind, but it can be used for just about anything.</p>
<h3>1. Installation</h3>
<p>ComplexHeatmap is available on Bioconductor:</p>
<div class="highlight"><pre><span></span><code><span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">requireNamespace</span><span class="p">(</span><span class="s">&quot;BiocManager&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">quietly</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
<span class="w">    </span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;BiocManager&quot;</span><span class="p">)</span>
<span class="n">BiocManager</span><span class="o">::</span><span class="nf">install</span><span class="p">(</span><span class="s">&quot;ComplexHeatmap&quot;</span><span class="p">)</span>
</code></pre></div>

<p>Or you can install it from GitHub:</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">devtools</span><span class="p">)</span>
<span class="nf">install_github</span><span class="p">(</span><span class="s">&quot;jokergoo/ComplexHeatmap&quot;</span><span class="p">)</span>
</code></pre></div>

<h3>2. Data wrangling</h3>
<p><code>ComplexHeatmap</code> accepts matrices in its main argument so make sure you've converted your data to numeric matrix form. We will look at crime statistics in U.S. cities from 1970 using data from the <code>cluster.datasets</code> package (which, by the way, contains lots of data suitable for heatmaps that are well formatted to the point where they are almost plug-and-play). The code for wrangling this data set is simple:</p>
<div class="highlight"><pre><span></span><code><span class="nf">library</span><span class="p">(</span><span class="n">cluster.datasets</span><span class="p">)</span>

<span class="nf">data</span><span class="p">(</span><span class="n">sample.us.city.crime.1970</span><span class="p">)</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">sample.us.city.crime.1970</span><span class="p">)</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample.us.city.crime.1970</span><span class="p">[,</span><span class="m">1</span><span class="p">]</span>
<span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="p">[,</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">)]</span>
<span class="nf">class</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;numeric&quot;</span><span class="p">)</span>
</code></pre></div>

<p><code>ComplexHeatmap</code> does not accept data tidy format! Make sure you have all your columns and rows in matrix format where a single value is at the intersection between a row and a column value. Note that rows and columns need to be labelled accordingly as these names will be displayed as your heatmap labels.</p>
<h3>3. The basic heatmap</h3>
<p>It's pretty easy to create a simple heatmap with your data matrix - just feed it to <code>Heatmap()</code> to glimpse your data. Let's also define the colours and names in this first step.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Set heatmap colours</span>
<span class="n">heatmap_colours</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">usyd_palette</span><span class="p">(</span><span class="s">&quot;ochre&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;continuous&quot;</span><span class="p">))</span>

<span class="c1"># Create the heatmap</span>
<span class="nf">Heatmap</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<span class="w">        </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;No. crimes&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">column_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Types of crime&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">row_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;American cities&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">heatmap_colours</span>
<span class="w">        </span><span class="p">)</span>
</code></pre></div>

<p><img alt="plot of basic heatmap" src="https://sydney-informatics-hub.github.io/tidbits/images/complex_heatmap/1_basic_heatmap.png"></p>
<p>You'll notice that dendrograms and clustering are automatically turned on. The default clustering setting is based on Euclidean distance. You can turn this off by specifying <code>cluster_rows = FALSE</code> and <code>cluster_columns = FALSE</code>.</p>
<h3>4. Clustering</h3>
<p>We usually want to cluster our heatmap to examine patterns of similarity/dissimilarity within the data. <code>Heatmap</code> accepts built-in clustering arguments based on other packages as well as custom arguments. Some examples of these are:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Relies on dist()</span>
<span class="n">clustering_method_rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;pearson&quot;</span>

<span class="c1"># Custom argument</span>
<span class="n">clustering_distance_rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">cor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>

<span class="c1"># k-means clustering</span>
<span class="c1"># This will automatically split your dataset (i.e. separates out the k-clustered blocks)</span>
<span class="n">row_km</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>

<span class="c1"># If you have already clustered/organised your matrix separately and want your heatmap to reflect that order</span>
<span class="n">row_order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">clustered_matrix</span><span class="p">[</span><span class="m">1</span><span class="p">,]</span>
</code></pre></div>

<p>These aren't exhaustive! Visit the ComplexHeatmap documentation to find out more (link at the bottom of the page).</p>
<p>Remember to use <code>set.seed</code> each time before clustering for reproducible results.</p>
<h3>5. Simple annotation</h3>
<p>Back to our crime data set. Let's say we've implemented some clustering and want to start annotating our heatmap. <code>Heatmap</code> accepts a lot of different types of annotations. Functions such as <code>top_annotation</code> and <code>right_annotation</code> can be specified either inside or outside of <code>Heatmap</code> depending on your preference. I've specified it outside for now.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create annotation for the top</span>
<span class="n">top_annotation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">HeatmapAnnotation</span><span class="p">(</span>
<span class="w">    </span><span class="n">groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">anno_block</span><span class="p">(</span>
<span class="w">      </span><span class="n">gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">gpar</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="p">),</span>
<span class="w">      </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Group 1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Group 2&quot;</span><span class="p">),</span><span class="w"> </span>
<span class="w">      </span><span class="n">labels_gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">gpar</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fontsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">)</span>
<span class="w">      </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>

<span class="c1"># Create heatmap</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span>
<span class="nf">Heatmap</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<span class="w">        </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;No. crimes&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">column_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Types of crime&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">row_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;American cities&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">clustering_distance_rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;pearson&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">column_km</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">        </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">heatmap_colours</span><span class="p">,</span>
<span class="w">        </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<span class="w">        </span><span class="n">top_annotation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">top_annotation</span><span class="p">,</span>
<span class="w">        </span><span class="n">rect_gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">gpar</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span>
</code></pre></div>

<p>You'll notice that <code>anno_block</code> is the argument for a rectangular block that can be used as a label (see below). <code>gp</code> and <code>gpar</code> define graphical parameters per annotation.</p>
<p><img alt="plot of clustered heatmap" src="https://sydney-informatics-hub.github.io/tidbits/images/complex_heatmap/4_top_annotation.png"></p>
<h3>6. A more complex annotation</h3>
<p>This is where things start to get groovy. First of all, let's switch our top annotation to a boxplot using <code>anno_box</code> so that we can get a more informative view of data per crime type. Next, we add row annotations with <code>rowAnnotation</code> to <code>Heatmap</code>. <code>rowAnnotation</code> is actually the same thing as <code>HeatmapAnnotation</code>, except it is specifically for use with rows rather than columns. The two annotations we'll add to the side are the total instances of the proportions of crime type per city as barplots using <code>anno_bar</code>. We will alter some of their aesthetic parameters as well in the code below.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create annotation for the top</span>
<span class="n">top_annotation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">HeatmapAnnotation</span><span class="p">(</span>
<span class="w">    </span><span class="n">`No. crimes committed in 1970`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">anno_boxplot</span><span class="p">(</span>
<span class="w">      </span><span class="n">data</span><span class="p">,</span>
<span class="w">      </span><span class="n">gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">gpar</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">7</span><span class="o">:</span><span class="m">1</span><span class="p">))</span>
<span class="w">      </span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Create heatmap</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span>
<span class="n">heatmap</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">Heatmap</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<span class="w">        </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;No. crimes&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">column_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Types of crime&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">row_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;American cities&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">clustering_distance_rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;pearson&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">column_km</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">        </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">heatmap_colours</span><span class="p">,</span>
<span class="w">        </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<span class="w">        </span><span class="n">top_annotation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">top_annotation</span><span class="p">,</span>
<span class="w">        </span><span class="n">rect_gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">gpar</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">rowAnnotation</span><span class="p">(</span>
<span class="w">          </span><span class="s">&quot;Total no. crimes&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">anno_barplot</span><span class="p">(</span>
<span class="w">            </span><span class="nf">rowSums</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
<span class="w">            </span><span class="n">gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">gpar</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;#FFE200&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span>
<span class="w">          </span><span class="n">show_annotation_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<span class="w">          </span><span class="n">annotation_name_rot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">90</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="nf">rowAnnotation</span><span class="p">(</span>
<span class="w">          </span><span class="s">&quot;Crime proportion&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">anno_barplot</span><span class="p">(</span>
<span class="w">            </span><span class="n">data</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">rowSums</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="p">,</span>
<span class="w">            </span><span class="n">gp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">gpar</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="o">:</span><span class="m">1</span><span class="p">),</span>
<span class="w">            </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">unit</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;cm&quot;</span><span class="p">),</span>
<span class="w">            </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span>
<span class="w">          </span><span class="n">show_annotation_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<span class="w">          </span><span class="n">annotation_name_rot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">90</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span>

<span class="c1"># Use auto_adjust to display the row names </span>
<span class="nf">draw</span><span class="p">(</span><span class="n">heatmap</span><span class="p">,</span><span class="w"> </span><span class="n">auto_adjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
</code></pre></div>

<p>It's important to note that we've saved <code>Heatmap</code> as an object and then pass it through <code>draw</code>. The <code>auto_adjust = FALSE</code> setting within draw makes sure that the row labels (cities in this case) are switched on, otherwise they automatically disappear.</p>
<p><img alt="plot of complex heatmap" src="https://sydney-informatics-hub.github.io/tidbits/images/complex_heatmap/5_complex_heatmap.png"></p>
<h3>Documentation</h3>
<p>This tidbit has only touched on some of the intricacies of this package. You can really go to town with annotating your heatmap - in fact, you can also plot two heatmaps side by side, use smaller heatmaps to annotate your main heatmap, or build huge annotations based on extra data. For a complete reference of how to use <code>ComplexHeatmap</code> (and a lot of cool examples), refer to: https://jokergoo.github.io/ComplexHeatmap-reference/book/</p>
    </div>
  </article>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
      <li class="list-inline-item"><a href="https://sydney-informatics-hub.github.io/tidbits/authors.html">Authors</a></li>
    <li class="list-inline-item"><a href="https://sydney-informatics-hub.github.io/tidbits/archives.html">Archives</a></li>
    <li class="list-inline-item"><a href="https://sydney-informatics-hub.github.io/tidbits/categories.html">Categories</a></li>
      <li class="list-inline-item"><a href="https://sydney-informatics-hub.github.io/tidbits/tags.html">Tags</a></li>
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
  </p>
</div>    </div>
  </footer>

  <script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://sydney-informatics-hub.github.io/tidbits/static/js/tipuesearch.min.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://sydney-informatics-hub.github.io/tidbits/static/js/tipuesearch_set.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://sydney-informatics-hub.github.io/tidbits/tipuesearch_content.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://sydney-informatics-hub.github.io/tidbits/static/js/activate_search.js" crossorigin="anonymous"></script>
</body>

</html>